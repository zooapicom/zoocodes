# Zoo 配置文件（客户部署用）
# 请根据实际环境修改以下配置

# ==================== MySQL 数据库配置 ====================
mysql:
  host: mysql:3306              # MySQL 地址（Docker Compose 内使用服务名 mysql，外部数据库填实际 IP:端口）
  username: zoo                  # MySQL 用户名
  password: zoo123456            # MySQL 密码（请修改为强密码）
  database: zoo                  # 数据库名
  max-idle-connections: 100
  max-open-connections: 100
  max-connection-life-time: 10s
  log-level: 4                   # GORM 日志级别: 1=silent, 2=error, 3=warn, 4=info

# ==================== Zoo 服务配置 ====================
server:
  mode: release                  # 运行模式: release(生产), debug(开发), test(测试)
  healthz: true                  # 是否开启健康检查 /healthz 路由
  middlewares: recovery,logger   # 中间件列表
  max-ping-count: 3              # 启动自检次数
  port: 8599                     # 服务端口
  tenant-monitoring: false       # 是否启用租户监控

# ==================== JWT 配置 ====================
jwt:
  realm: JWT                                          # JWT 标识
  key: PLEASE_CHANGE_THIS_SECRET_KEY_TO_RANDOM_STRING # ⚠️ 请务必修改为随机字符串（32位以上）
  timeout: 24h                                        # Token 过期时间
  max-refresh: 24h                                    # Token 刷新时间

# ==================== Redis 配置 ====================
redis:
  host: redis                    # Redis 地址（Docker Compose 内使用服务名 redis，外部填实际 IP）
  port: 6379                     # Redis 端口
  password: ""                   # Redis 密码（如有密码请填写）
  database: 0                    # Redis 数据库编号

# ==================== 邮件配置 ====================
# 注意：如使用 Gmail，需要开启"应用专用密码"：https://myaccount.google.com/apppasswords
mail:
  service-type: "smtp"                     # 邮件服务类型: smtp 或 sendgrid
  smtp-host: "smtp.gmail.com"              # SMTP 服务器地址
  smtp-port: 587                           # SMTP 端口
  smtp-username: "your-email@gmail.com"    # ⚠️ 请修改为实际邮箱
  smtp-password: "your-app-password"       # ⚠️ 请修改为 SMTP 密码（Gmail 应用专用密码）
  smtp-use-tls: true                       # 是否使用 TLS
  sendgrid-api-key: ""                     # SendGrid API Key（使用 SendGrid 时填写）
  from-email: "your-email@gmail.com"       # 发件人邮箱
  from-name: "Zoo系统"                      # 发件人名称
  verification-code-expire: 300            # 验证码过期时间（秒）
  send-code-limit: 60                      # 发送验证码间隔（秒）

# ==================== 短信配置 ====================
# 可选：如不使用短信功能，保持 provider: "mock" 即可
sms:
  provider: "mock"                         # 短信提供商: aliyun/tencent/mock
  access-key-id: ""                        # 短信服务 AccessKeyID
  access-key-secret: ""                    # 短信服务 AccessKeySecret
  sign-name: "Zoo"                         # 短信签名
  verification-template-id: ""             # 验证码模板 ID
  send-code-limit: 60
  code-expire: 300

# ==================== 支付配置 ====================
# 可选：如不使用支付功能，可暂时保留默认配置
payment:
  epay-pay-url: "http://localhost:8200/payment.html"
  epay-api-url: "https://your-payment-gateway.com"
  epay-create-order-uri: "/mapi.php"
  epay-query-status-uri: "/api.php?act=order&pid={pid}&key={key}&out_trade_no={out_trade_no}"
  epay-pid: ""                             # 商户 ID
  epay-key: ""                             # 商户密钥
  epay-notify-url: "https://your-domain.com/trade/payments/notify"
  epay-return-url: "http://localhost:8200/payment.html"
  epay-test-mode: false

# ==================== 推广配置 ====================
referral:
  link-prefix: "http://localhost:8599/web/reg.html"  # 推广链接前缀（改为实际域名）

# ==================== 外部代理配置 ====================
# 可选：如不使用 ChatGPT 等外部服务，设置 chatgpt-enabled: false
external-proxy:
  chatgpt-enabled: false                   # 是否启用 ChatGPT 服务
  chatgpt-base-url: ""                     # ChatGPT 服务地址
  chatgpt-session-add-uri: "/adminapi/chatgpt/session/add"
  chatgpt-session-update-uri: "/adminapi/chatgpt/session/update"
  chatgpt-session-delete-uri: "/adminapi/chatgpt/session/delete"
  chatgpt-session-info-uri: "/adminapi/chatgpt/session/info?id=%d"
  chatgpt-session-search-uri: "/adminapi/chatgpt/session/page"
  chatgpt-auth-header: ""
  conversation-add-uri: "/adminapi/chatgpt/conversations/add"
  conversation-update-uri: "/adminapi/chatgpt/conversations/update"
  conversation-delete-uri: "/adminapi/chatgpt/conversations/delete"
  timeout: 30

# ==================== 许可证验证配置 ====================
# 说明：启用后，应用会向许可证服务验证授权状态
# 如不使用许可证功能，设置 enabled: false
license:
  enabled: false                           # 是否启用许可证验证
  
  # ========== 必需配置（启用时必填）==========
  server_url: ""                           # 许可证服务地址，如 https://license.yourcompany.com
  
  # 公钥 PEM（RSA/ECDSA 格式，用于验证服务端签名）
  # 示例格式：
  # public_key_pem: |
  #   -----BEGIN PUBLIC KEY-----
  #   MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...
  #   -----END PUBLIC KEY-----
  public_key_pem: ""
  
  # 客户端私钥 PEM（用于请求签名）
  client_private_key_pem: ""
  
  # ========== 可选配置 ==========
  domain: ""                               # 授权域名（可通过环境变量 ZOO_LICENSE_DOMAIN 设置）
  check_interval_seconds: 3600             # 验证间隔（秒），默认 3600（1小时）
  timeout_seconds: 10                      # 请求超时（秒）
  fail_closed: true                        # 服务不可用时是否拒绝访问
  cache_ttl_seconds: 300                   # 验证结果缓存时间（秒）
  cert_fingerprint: ""                     # 许可证服务证书指纹（SHA256，可选）
  timestamp_window_seconds: 300            # 响应时间戳验证窗口（秒）

# ==================== 部署后操作 ====================
# 1. 修改以上带 ⚠️ 标记的必填配置项
# 2. 根据实际需求调整可选配置
# 3. 保存文件后执行: docker compose restart zoo
# 4. 查看日志: docker compose logs -f zoo
